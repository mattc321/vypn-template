/**
 * Created by mcampbell on 6/12/2017.
 */

window.onload = function(e){
    console.log('::Loaded some fuckin vypn js::');

    //[+] LISTENERS

    //form navigation
    var nxt1 = document.getElementById('next_btn1');
    if(nxt1){
        //document.getElementById("first").style.display="none";
        nxt1.addEventListener('click', next_step1, false);
    }

    var nxt2 = document.getElementById('back_btn1');
    if(nxt2){
        nxt2.addEventListener('click', prev_step1, false);
    }

    var nxt3 = document.getElementById('back_btn2');
    if(nxt3){
        nxt3.addEventListener('click', prev_step2, false);
    }

    var nxt4 = document.getElementById('next_btn2');
    if(nxt4){
        nxt4.addEventListener('click', next_step2, false);
    }

    //business info checkboxes
    var classname = document.getElementsByClassName('check-cont');
    if(classname){
        for (var i = 0; i < classname.length; i++) {
            classname[i].addEventListener('click', function(e){ //say this is an anchor
                //do something
                e.preventDefault();
                e.stopPropagation()
                addMyClass(this, "checked");
            });
        }
    }


} // End window load

/*------------validation functions-----------------*/
function validate_step3(){
    var txtvolume  = document.getElementById('volume');
    var txtvtbp  = document.getElementById('vtbp');
    var i = 0;

    if (txtvolume.value.length == 0) {
        i=1;
        if (!txtvolume.classList.contains('failed')) {
            addMyClass(txtvolume, 'failed');
        }
    } else {
        txtvolume.classList.remove('failed');
    }

    if (txtvtbp.value.length == 0) {
        i=1;
        if (!txtvtbp.classList.contains('failed')) {
            addMyClass(txtvtbp, 'failed');
        }
    } else {
        txtvtbp.classList.remove('failed');
    }

    //finish
    if (i > 0) {
        tellEm('Some of these form fields are required.', 'tellem2');
        return false;
    } else {
        txtvolume.classList.remove('failed');
        txtvtbp.classList.remove('failed');

        tellEm('', 'tellem2');
        return true;
    }
}

function validate_step1(event){
    event.preventDefault();
    event.stopPropagation();
    var vmsg = "";
    var i = 0;
    //fetching radio button by name
    var txtname = document.getElementById('name');
    var txtemail  = document.getElementById('email');
    var txtbusiness  = document.getElementById('business');
    var txtwebsite  = document.getElementById('website');


    if (txtname.value.length == 0) {
        i=1;
        if (!txtname.classList.contains('failed')) {
            addMyClass(txtname, 'failed');
        }
    } else {
        txtname.classList.remove('failed');
    }

    if (txtemail.value.length == 0) {
        i=1;
        if (!txtemail.classList.contains('failed')) {
            addMyClass(txtemail, 'failed');
        }
    } else {
        txtemail.classList.remove('failed');
    }

    if (txtbusiness.value.length == 0) {
        i=1;
        if (!txtbusiness.classList.contains('failed')) {
            addMyClass(txtbusiness, 'failed');
        }
    } else {
        txtbusiness.classList.remove('failed');
    }

    if (txtwebsite.value.length == 0) {
        i=1;
        if (!txtwebsite.classList.contains('failed')) {
            addMyClass(txtwebsite, 'failed');
        }
    } else {
        txtwebsite.classList.remove('failed');
    }

    //finish
    if (i > 0) {
        tellEm('Some of these form fields are required.', 'tellem');
        return false;
    } else {
        txtname.classList.remove('failed');
        txtemail.classList.remove('failed');
        txtbusiness.classList.remove('failed');
        txtwebsite.classList.remove('failed');

        tellEm('', 'tellem');
        return true;
    }

}

function tellEm(msg, el) {
    var targetMsg = document.getElementById(el);
    var og = targetMsg.innerHTML;
    if (msg == '') {
        targetMsg.innerHTML = '';
    } else {
        targetMsg.innerHTML = '<p class="targetMsg">'+msg+'</p>';
    }
}
/*----------End validate-----------------------------------------------*/

/*------------Form Navigation and Animation functions-----------------*/
//Function that executes on click of first next button
function next_step1(){

    if (validate_step1(event) == false) {

    } else {
        addAnimation(document.getElementById("first"), 'bounceOutRight');

        setTimeout(function() {
            document.getElementById("first").style.display="none";
            document.getElementById("second").style.opacity=0;
            document.getElementById("second").style.display="block";
            addAnimation(document.getElementById("second"), 'bounceIn');
            document.getElementById("second").style.opacity=1;
            document.getElementById("first").style.display="none";
            addAnimation(document.getElementById("first"), 'bounceOutRight');
        },400)
    }
}

//Function that executes on click of first previous button
function prev_step1(){
    addAnimation(document.getElementById("second"), 'bounceIn'); //calling this again actually removes the first instance
    document.getElementById("first").style.display="block";
    document.getElementById("second").style.display="none";
}

//Function that executes on click of second next button
function next_step2(){

    addAnimation(document.getElementById("second"), 'bounceOutRight');

    setTimeout(function() {
        document.getElementById("second").style.display="none";
        document.getElementById("third").style.opacity=0;
        document.getElementById("third").style.display="block";
        addAnimation(document.getElementById("third"), 'bounceIn');
        document.getElementById("third").style.opacity=1;
        document.getElementById("second").style.display="none";
        addAnimation(document.getElementById("second"), 'bounceOutRight');
    },400)
}

//Function that executes on click of second previous button
function prev_step2(){
    addAnimation(document.getElementById("third"), 'bounceIn'); //calling this again actually removes the first instance
    document.getElementById("third").style.display="none";
    document.getElementById("second").style.display="block";
}

/*----------End Form Navigation-----------------------------------------------*/

/*----------Extra Supporting Functions and Shit-------------------------------*/
function addMyClass(param, classToAdd) {
    //if it has the class
    if (param.classList.contains(classToAdd)) {
        param.classList.remove(classToAdd);
    } else {
        //if it doesnt have the class add it
        var classString = param.className; // returns the string of all the classes for element
        var newClass = classString.concat(" " + classToAdd);
        param.className = newClass;
    }
}

function addAnimation(param, classAnimate) {
    //if it has the class
    if (param.classList.contains(classAnimate)) {
        param.classList.remove('animated');
        param.classList.remove(classAnimate);
    } else {
        //if it doesnt have the class add it
        var classString = param.className; // returns the string of all the classes for element
        var newClass = classString.concat(" animated " + classAnimate);
        param.className = newClass;
    }
}
